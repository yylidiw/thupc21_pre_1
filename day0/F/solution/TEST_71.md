#### 题目描述

给定一个长为 $n$ 的序列 $a$，定义 $x$ 为区间 $[l,r]$ 的众数当且仅当不存在 $y$ 使得 $y$ 在区间 $[l,r]$ 中的出现次数大于 $x$ 在区间 $[l,r]$ 中的出现次数。

有 $m$ 次询问，每次询问给出 $l,r$，求有多少二元组 $(l',r')$ 满足 $l \le l' \le r' \le r$ ，且 $[l',r']$ 的区间长度为奇数，且 **$(l'+r')/2$** 是区间 $[l',r']$ 中的众数。

#### 数据范围

$1\le n\le 3\cdot 10^5，1\le m\le 10^6$，所有数值为整数。

#### 输入格式

第一行两个数 $n$ $m$。

之后一行 $n$ 个数表示这个序列。

之后 $m$ 行，每行两个数 $l$ $r$ 表示一次询问。

#### 输出格式

共 $m$ 行，表示每个询问对应的答案。



#### 题解

考虑枚举每个点作为中间点，可行的以其为众数的区间。

对于每个 $x$ 位置的值，其值为 $y$，出现了 $z$ 次，则以 $x$ 为中间并为众数的可行区间的段数为 $O(z)$ 段，这些段一定会以一个值为 $y$ 的位置开始，并延伸一段距离后结束。

我们可以用一些分块的trick来 $O(\sqrt n)$ 复杂度定位出一段，这样总段数为 $O(n)$ 段，这里预处理时间复杂度 $O(n\sqrt n)$。

然后就变为二维数点问题，可以 $O(\log n)$ 处理一次询问。

总时间复杂度 $O(n\sqrt n+m\log n)$。